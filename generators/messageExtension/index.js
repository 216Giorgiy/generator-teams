module.exports=function(e){var t={};function s(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,s),o.l=!0,o.exports}return s.m=e,s.c=t,s.d=function(e,t,n){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.w={},s(s.s=9)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("guid")},function(e,t){e.exports=require("yosay")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let n=s(0);const o="package.json";t.Yotilities=class{static validateUrl(e){return/(https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}static fixFileNames(e,t){if(void 0!==e){var s=n.basename(e);if("_"===s[0]){e="."+s.substr(1);var o=n.dirname(e);e=n.join(o,e)}for(var i in t)t.hasOwnProperty(i)&&"string"==typeof t[i]&&(e=e.replace(new RegExp("{"+i+"}","g"),t[i]))}return e}static addAdditionalDeps(e,t){var s=t.readJSON(o);e.forEach(e=>{s.dependencies[e[0]]=e[1]}),t.writeJSON(o,s)}}},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("yeoman-generator")},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(5),o=s(4),i=s(3);s(2),s(0);let a=s(1);t.MessageExtensionGenerator=class extends n{constructor(e,t){super(e,t),t.force=!0,this.options=t.options,this.desc("Adds a Message Extension to a Microsoft Teams Apps project")}prompting(){if(this.options.messageExtension)return this.prompt([{type:"list",name:"messageExtensionType",message:"What type of Message Extension would you like to create ",default:e=>"botframework"==this.options.botType?"existing":"new",choices:e=>{var t=[];return t.push({name:"For a Bot hosted somewhere else",value:"external"}),"botframework"==this.options.botType?t.push({name:"For the Bot created in this project",value:"existing"}):t.push({name:"For a new Bot",value:"new"}),t}},{type:"input",name:"messageExtensionId",message:e=>"I need the Microsoft App ID for the Bot used by the Message Extension. ",default:e=>a.EMPTY,validate:e=>a.isGuid(e),when:e=>"existing"!==e.messageExtensionType},{type:"input",name:"messageExtensionName",message:"What is the name of your Message Extension command?",default:this.options.title+" Message Extension",validate:e=>e.length>0},{type:"input",name:"messageExtensionDescription",message:"Describe your Message Extension command?",default:`Description of ${this.options.title} message extension`,validate:e=>e.length>0}]).then(e=>{this.options.messageExtensionId=e.messageExtensionId,this.options.messageExtensionType=e.messageExtensionType,this.options.messageExtensionTitle=e.messageExtensionName,this.options.messageExtensionDescription=e.messageExtensionDescription,this.options.messageExtensionName=o.camelCase(e.messageExtensionName),"new"==e.messageExtensionType?(this.options.bot=!0,this.options.botid=e.messageExtensionId,this.options.botType="botframework",this.options.botTitle=e.messageExtensionName+" Bot",this.options.botName=o.camelCase(this.options.botTitle)):"existing"==e.messageExtensionType&&(this.options.messageExtensionId=this.options.botid)})}writing(){if(this.options.messageExtension){let t="src/manifest/manifest.json";var e=this.fs.readJSON(t);e.composeExtensions||(e.composeExtensions=[]),e.composeExtensions.push({botId:this.options.messageExtensionId,canUpdateConfiguration:!0,commands:[{id:this.options.messageExtensionName,title:this.options.messageExtensionTitle,description:"Add a clever description here",initialRun:!0,parameters:[{name:"parameter",description:"Description of the parameter",title:"Parameter"}]}]}),this.fs.writeJSON(t,e);let s=[];s.push("src/app/scripts/{messageExtensionName}Config.tsx","src/app/web/{messageExtensionName}Config.html"),s.forEach(e=>{this.fs.copyTpl(this.templatePath(e),i.Yotilities.fixFileNames(e,this.options),this.options)});let n="src/app/scripts/client.ts",o=this.fs.read(n);o+="\n// Added by generator-teams",o+=`\nexport * from './${this.options.messageExtensionName}Config';`,o+="\n",this.fs.write(n,o)}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=s(7);e.exports=n.MessageExtensionGenerator},function(e,t,s){e.exports=s(8)}]);