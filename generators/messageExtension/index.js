module.exports=function(e){var t={};function s(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=e,s.c=t,s.d=function(e,t,o){s.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:o})},s.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.w={},s(s.s=9)}([function(e,t){e.exports=require("path")},function(e,t){e.exports=require("guid")},function(e,t){e.exports=require("yosay")},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let o=s(0);const i="package.json";t.Yotilities=class{static validateUrl(e){return/(https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)}static fixFileNames(e,t){if(void 0!==e){var s=o.basename(e);if("_"===s[0]){e="."+s.substr(1);var i=o.dirname(e);e=o.join(i,e)}for(var n in t)t.hasOwnProperty(n)&&"string"==typeof t[n]&&(e=e.replace(new RegExp("{"+n+"}","g"),t[n]))}return e}static addAdditionalDeps(e,t){var s=t.readJSON(i);e.forEach(e=>{s.dependencies[e[0]]=e[1]}),t.writeJSON(i,s)}}},function(e,t){e.exports=require("lodash")},function(e,t){e.exports=require("yeoman-generator")},,function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(5),i=s(4),n=s(3);s(2),s(0);let a=s(1);t.MessageExtensionGenerator=class extends o{constructor(e,t){super(e,t),t.force=!0,this.options=t.options,this.desc("Adds a Message Extension to a Microsoft Teams Apps project")}prompting(){if(this.options.messageExtension)return this.prompt([{type:"list",name:"messageExtensionType",message:"What type of Message Extension would you like to create ",default:e=>"botframework"==this.options.botType?"existing":"new",choices:e=>{var t=[];return t.push({name:"For a Bot hosted somewhere else",value:"external"}),"botframework"==this.options.botType?t.push({name:"For the Bot created in this project",value:"existing"}):t.push({name:"For a new Bot",value:"new"}),t}},{type:"input",name:"messageExtensionId",message:e=>"I need the Microsoft App ID for the Bot used by the Message Extension. ",default:e=>a.EMPTY,validate:e=>a.isGuid(e),when:e=>"existing"!==e.messageExtensionType},{type:"input",name:"messageExtensionName",message:"What is the name of your Message Extension command?",default:this.options.title+" Message Extension",validate:e=>e.length>0},{type:"input",name:"messageExtensionDescription",message:"Describe your Message Extension command?",default:`Description of ${this.options.title} message extension`,validate:e=>e.length>0}]).then(e=>{this.options.messageExtensionId=e.messageExtensionId,this.options.messageExtensionType=e.messageExtensionType,this.options.messageExtensionTitle=e.messageExtensionName,this.options.messageExtensionDescription=e.messageExtensionDescription,this.options.messageExtensionName=i.camelCase(e.messageExtensionName),"new"==e.messageExtensionType?(this.options.bot=!0,this.options.botid=e.messageExtensionId,this.options.botType="botframework",this.options.botTitle=e.messageExtensionName+" Bot",this.options.botName=i.camelCase(this.options.botTitle)):"existing"==e.messageExtensionType&&(this.options.messageExtensionId=this.options.botid)})}writing(){if(this.options.messageExtension){let t="src/manifest/manifest.json";var e=this.fs.readJSON(t);e.composeExtensions||(e.composeExtensions=[]),e.composeExtensions.push({botId:this.options.messageExtensionId,canUpdateConfiguration:!0,commands:[{id:this.options.messageExtensionName,title:this.options.messageExtensionTitle,description:"Add a clever description here",initialRun:!0,parameters:[{name:"parameter",description:"Description of the parameter",title:"Parameter"}]}]}),this.fs.writeJSON(t,e);let s=[];s.push("src/app/scripts/{messageExtensionName}Config.tsx","src/app/web/{messageExtensionName}Config.html"),s.forEach(e=>{this.fs.copyTpl(this.templatePath(e),n.Yotilities.fixFileNames(e,this.options),this.options)}),n.Yotilities.addAdditionalDeps([["msteams-ui-components-react","^0.5.0"],["react","^16.1.0"],["@types/react","16.0.38"],["react-dom","^16.2.0"],["file-loader","1.1.6"],["typestyle","1.5.1"]],this.fs);let o="src/app/scripts/client.ts",i=this.fs.read(o);i+="\n// Added by generator-teams",i+=`\nexport * from './${this.options.messageExtensionName}Config';`,i+="\n",this.fs.write(o,i)}}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const o=s(7);e.exports=o.MessageExtensionGenerator},function(e,t,s){e.exports=s(8)}]);